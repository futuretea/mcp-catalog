name: Dynatrace
shortDescription: 使用 Dynatrace 可观测性查询日志、指标、追踪并管理问题
description: |

  一个用于 Dynatrace 集成的 Model Context Protocol (MCP) 服务器，通过 Dynatrace API 提供全面的可观测性和监控能力。

  ## 功能特性
  - **从兼容的 AI 应用程序访问 Dynatrace 可观测性数据**
  - **使用自然语言查询日志、指标、追踪和事件**
  - **通过 Dynatrace API 管理问题、漏洞和实体**
  - **基于 Dynatrace 监控数据生成报告和洞察**
  - **分析性能数据并获取 AI 驱动的故障排除建议**

  ## 连接所需信息

  **必需凭证**：
  - `DT_PLATFORM_TOKEN`：您的 Dynatrace Platform Token。要创建平台令牌，请参阅 [Dynatrace 文档](https://www.dynatrace.com/support/help/shortlink/platform-tokens) 获取更多详情。
  - `DT_ENVIRONMENT`：您的 Dynatrace 环境 URL（例如 https://abc12345.apps.dynatrace.com）


metadata:
  categories: 监控, 开发者工具, DevOps
  allow-multiple: "true"
icon: https://avatars.githubusercontent.com/u/58178984?s=48&v=4
repoURL: https://github.com/dynatrace-oss/dynatrace-mcp
env:
- key: DT_PLATFORM_TOKEN
  name: Dynatrace Platform Token
  required: true
  sensitive: true
  description: 您的 Dynatrace Platform Token。
- key: DT_ENVIRONMENT
  name: Dynatrace Environment
  required: true
  sensitive: false
  description: 您的 Dynatrace 环境 URL
runtime: containerized
containerizedConfig:
  image: ghcr.io/obot-platform/mcp-images/dynatrace:1.0.0
  port: 8099
  path: /
  args:
  - mcp-server-dynatrace
toolPreview:
- name: get_environment_info
  description: 获取有关连接的 Dynatrace 环境（租户）的信息，并验证连接和认证。
  params:
    random_string: "无参数工具的虚拟参数"

# 漏洞管理
- name: list_vulnerabilities
  description: 列出 Dynatrace 中最近 30 天的所有非静音漏洞。可以使用 DQL 过滤器提供额外的过滤条件。
  params:
    additionalFilter: "漏洞的 DQL 语句额外过滤器，例如 'vulnerability.stack == \"CODE_LIBRARY\"' 或 'vulnerability.risk.level == \"CRITICAL\"'"
    maxVulnerabilitiesToDisplay: "响应中显示的最大漏洞数量（默认：25）"
    riskScore: "要列出的漏洞的最低风险评分（默认：8.0）"

# 问题管理
- name: list_problems
  description: 列出 Dynatrace 上已知的所有问题（dt.davis.problems），按最近发生时间排序，最近 12 小时。可以使用 DQL 过滤器提供额外的过滤条件。
  params:
    additionalFilter: "dt.davis.problems 的 DQL 语句额外过滤器，例如 'entity_tags == array(\"dt.owner:team-foobar\", \"tag:tag\")'"
    maxProblemsToDisplay: "响应中显示的最大问题数量（默认：10）"

# 实体管理
- name: find_entity_by_name
  description: 根据 Dynatrace 上实体的名称，在拓扑中获取受监控实体（服务、主机、进程组、应用程序、kubernetes 节点等）的 entityId。
  params:
    entityName: "要搜索的实体名称，例如 \"my-service\" 或 \"my-host\""

- name: get_entity_details
  description: 根据 Dynatrace 上的 entityId 获取受监控实体的详细信息。
  params:
    entityId: "要获取详细信息的实体 ID"

- name: get_ownership
  description: 获取 Dynatrace 上一个或多个实体的详细所有权信息。
  params:
    entityIds: "以逗号分隔的 entityId 列表"

# 数据查询（GRAIL）
- name: execute_dql
  description: 通过执行 Dynatrace Query Language (DQL) 语句，从 Dynatrace GRAIL 获取日志、指标、追踪或事件。
  params:
    dqlStatement: "DQL 语句（例如：\"fetch [logs, spans, events] | filter <some-filter> | summarize count(), by:{some-fields}.\"，或用于指标：\"timeseries { avg(<metric-name>), value.A = avg(<metric-name>, scalar: true) }\")"

- name: verify_dql
  description: 在执行之前验证 Dynatrace GRAIL 上的 Dynatrace Query Language (DQL) 语句。对于由非专业工具动态创建的 DQL 语句，建议执行此步骤。
  params:
    dqlStatement: "要验证的 DQL 语句"

- name: explain_dql_in_natural_language
  description: 使用 Davis CoPilot AI 以自然语言解释 Dynatrace Query Language (DQL) 语句。
  params:
    dql: "要解释的 DQL 语句"

# AI 助手
- name: chat_with_davis_copilot
  description: "在没有特定工具可用时使用此工具。获取任何 Dynatrace 相关问题的答案以及故障排除和指导。*(注意：Davis CoPilot AI 已正式发布，但 Davis CoPilot API 处于预览阶段)*"
  params:
    text: "您的问题或 Davis CoPilot 的请求"
    context: "提供额外信息的可选上下文"
    instruction: "格式化响应的可选指令"

# Kubernetes 集成
- name: get_kubernetes_events
  description: 从特定的 Kubernetes (K8s) 集群获取所有事件。
  params:
    clusterId: "Kubernetes (K8s) 集群 ID，称为 k8s.cluster.uid（这不是 Dynatrace 环境）"

# 通信与通知
- name: send_slack_message
  description: 通过 Dynatrace 上的 Slack Connector 向专用 Slack 频道发送 Slack 消息。
  params:
    channel: "要发送消息的 Slack 频道"
    message: "要发送的消息内容"

- name: send_email
  description: 使用 Dynatrace Email API 发送电子邮件。发件人将是 no-reply@apps.dynatrace.com。TO、CC 和 BCC 总共最多 10 个收件人。
  params:
    toRecipients: "TO 收件人的电子邮件地址数组"
    subject: "电子邮件的主题行"
    body: "电子邮件的正文内容（仅纯文本）"
    ccRecipients: "CC 收件人的电子邮件地址数组"
    bccRecipients: "BCC 收件人的电子邮件地址数组"

# 工作流管理
- name: make_workflow_public
  description: 修改工作流并使其对 Dynatrace 环境中的所有人公开可用。
  params:
    workflowId: "要公开的工作流 ID"

# 预算管理
- name: reset_grail_budget
  description: 在 Grail 查询预算耗尽后重置它，允许执行新查询。这将清除当前会话中所有跟踪的已扫描字节数。
  params:
    random_string: "无参数工具的虚拟参数"
