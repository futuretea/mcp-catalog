name: Terraform
shortDescription: 管理 Terraform Cloud 工作区、运行、变量，并浏览注册表
description: |
  一个 Model Context Protocol (MCP) 服务器，提供与 Terraform 生态系统的无缝集成，为基础设施即代码 (IaC) 开发实现高级自动化和交互功能。连接到 Terraform Cloud 或 Terraform Enterprise 以管理工作区、运行、变量，并浏览 Terraform Registry。

  ## 功能特性
  - **工作区管理**: 创建、更新、列出和管理 Terraform Cloud/Enterprise 工作区
  - **运行操作**: 创建和监控 Terraform 运行 (计划和应用)
  - **变量管理**: 管理组织中的工作区变量和变量集
  - **注册表搜索**: 搜索和检索公共模块、提供者和策略的文档
  - **私有注册表**: 访问您组织的私有模块和提供者
  - **标签管理**: 使用标签组织工作区以进行更好的管理
  - **组织管理**: 列出和管理 Terraform 组织和项目

  ## 连接所需条件

  **必需:**
  - **Terraform Cloud/Enterprise Token**: 用于认证的 API 令牌。在 Terraform Cloud 的用户设置 > 令牌中生成。

  **可选:**
  - **Terraform Address**: HCP Terraform 或 Terraform Enterprise 地址。默认为 https://app.terraform.io

metadata:
  categories: DevOps, 云基础设施, 自动化
icon: https://raw.githubusercontent.com/hashicorp/terraform-mcp-server/5530ac1e1bc26b0e863fcd55634ea550bea18883/public/images/Terraform-LogoMark_onDark.svg
repoURL: https://github.com/hashicorp/terraform-mcp-server

toolPreview:
- name: list_terraform_orgs
  description: 列出您有权访问的所有 Terraform 组织。在执行其他操作之前使用此工具发现可用的组织。
  params:
    page: "可选。分页的页码 (最小 1)"
    pageSize: "可选。分页的每页结果数 (最小 1，最大 100)"
- name: list_terraform_projects
  description: 列出 Terraform 组织中的所有项目。项目有助于组织工作区。
  params:
    terraform_org_name: "要列出项目的 Terraform 组织名称"
    page: "可选。分页的页码 (最小 1)"
    pageSize: "可选。分页的每页结果数 (最小 1，最大 100)"
- name: list_workspaces
  description: 搜索和列出组织中的 Terraform 工作区。未应用过滤器时返回所有工作区，或按名称模式、标签或搜索查询过滤。
  params:
    terraform_org_name: "Terraform 组织名称"
    search_query: "可选。按名称过滤工作区的搜索查询"
    wildcard_name: "可选。匹配工作区名称的通配符模式"
    tags: "可选。用于过滤工作区的逗号分隔标签列表"
    exclude_tags: "可选。要从结果中排除的逗号分隔标签列表"
    project_id: "可选。用于过滤工作区的项目 ID"
    page: "可选。分页的页码 (最小 1)"
    pageSize: "可选。分页的每页结果数 (最小 1，最大 100)"
- name: create_workspace
  description: 在指定组织中创建新的 Terraform 工作区。这是一个破坏性操作，在运行应用时将创建新的基础设施资源。
  params:
    terraform_org_name: "Terraform 组织名称"
    workspace_name: "要创建的工作区名称"
    description: "可选。工作区描述"
    auto_apply: "可选。是否自动应用成功的计划: ''true'' 或 ''false'' (默认: ''false'')"
    execution_mode: "可选。执行模式: ''remote''、''local'' 或 ''agent'' (默认: ''remote'')"
    terraform_version: "可选。要使用的 Terraform 版本 (例如 ''1.5.0'')"
    working_directory: "可选。Terraform 操作的工作目录"
    project_id: "可选。要关联工作区的项目 ID"
    tags: "可选。要应用到工作区的逗号分隔标签列表"
    vcs_repo_identifier: "可选。VCS 仓库标识符 (例如 ''org/repo'')"
    vcs_repo_branch: "可选。VCS 仓库分支 (默认: main/master)"
    vcs_repo_oauth_token_id: "可选。VCS 集成的 OAuth 令牌 ID"
- name: update_workspace
  description: 更新现有的 Terraform 工作区配置。这是一个潜在的破坏性操作，可能会影响基础设施资源。
  params:
    terraform_org_name: "Terraform 组织名称"
    workspace_name: "要更新的工作区名称"
    new_name: "可选。工作区的新名称"
    description: "可选。工作区的新描述"
    auto_apply: "可选。是否自动应用成功的计划: ''true'' 或 ''false''"
    execution_mode: "可选。执行模式: ''remote''、''local'' 或 ''agent''"
    terraform_version: "可选。要使用的新 Terraform 版本"
    working_directory: "可选。新的工作目录"
    tags: "可选。用于替换现有标签的逗号分隔标签列表"
    queue_all_runs: "可选。是否排队所有运行: ''true'' 或 ''false''"
    speculative_enabled: "可选。是否启用推测性计划: ''true'' 或 ''false''"
    trigger_prefixes: "可选。逗号分隔的触发前缀列表"
    file_triggers_enabled: "可选。是否启用文件触发器: ''true'' 或 ''false''"
- name: get_workspace_details
  description: 获取特定 Terraform 工作区的详细信息，包括配置、变量和当前状态信息。
  params:
    terraform_org_name: "Terraform 组织名称"
    workspace_name: "要获取详细信息的工作区名称"
- name: list_runs
  description: 在工作区或组织中列出或搜索 Terraform 运行，可选择按状态和其他条件过滤。
  params:
    terraform_org_name: "Terraform 组织名称"
    workspace_name: "可选。如果指定，则列出给定工作区中的运行，而不是组织中的运行"
    status: "可选。运行状态过滤器数组 (例如 [''pending'', ''planning'', ''applied''])"
    vcs_username: "可选。搜索与 VCS 用户名匹配的运行"
    page: "可选。分页的页码 (最小 1)"
    pageSize: "可选。分页的每页结果数 (最小 1，最大 100)"
- name: create_run
  description: 在指定工作区中创建新的 Terraform 运行 (计划/应用)。这将启动基础设施更改。
  params:
    terraform_org_name: "Terraform 组织名称"
    workspace_name: "要创建运行的工作区名称"
    message: "可选。运行的消息"
    run_type: "可选。运行类型: ''plan_and_apply''、''refresh_state''、''plan_only'' 或 ''allow_empty_apply'' (默认: ''plan_and_apply'')"
- name: get_run_details
  description: 获取特定 Terraform 运行的详细信息，包括状态、日志和资源更改。
  params:
    run_id: "要获取详细信息的运行 ID"
- name: list_workspace_variables
  description: 列出 Terraform 工作区中的所有变量。如果查询为空，则返回所有变量。
  params:
    terraform_org_name: "Terraform 组织名称"
    workspace_name: "工作区名称"
    page: "可选。分页的页码 (最小 1)"
    pageSize: "可选。分页的每页结果数 (最小 1，最大 100)"
- name: create_workspace_variable
  description: 在 Terraform 工作区中创建新变量。变量可以是 Terraform 变量或环境变量。
  params:
    terraform_org_name: "Terraform 组织名称"
    workspace_name: "工作区名称"
    key: "变量键/名称"
    value: "变量值"
    category: "变量类别: ''terraform'' 或 ''env'' (默认: ''env'')"
    description: "可选。变量描述"
    sensitive: "可选。变量是否敏感: true 或 false (默认: false)"
    hcl: "可选。变量是否为 HCL: true 或 false (默认: false)"
- name: update_workspace_variable
  description: 更新 Terraform 工作区中的现有变量。
  params:
    terraform_org_name: "Terraform 组织名称"
    workspace_name: "工作区名称"
    variable_id: "要更新的变量 ID"
    key: "变量键/名称"
    value: "变量值"
    description: "可选。变量描述"
    sensitive: "可选。变量是否敏感: true 或 false"
    hcl: "可选。变量是否为 HCL: true 或 false"
- name: list_variable_sets
  description: 列出组织中的所有变量集。变量集允许您在多个工作区之间共享变量。
  params:
    terraform_org_name: "Terraform 组织名称"
    query: "可选。用于变量集名称的过滤查询"
    page: "可选。分页的页码 (最小 1)"
    pageSize: "可选。分页的每页结果数 (最小 1，最大 100)"
- name: create_variable_set
  description: 在组织中创建新的变量集。变量集可以应用于多个工作区。
  params:
    terraform_org_name: "Terraform 组织名称"
    name: "变量集名称"
    description: "可选。变量集描述"
    global: "可选。变量集是否为全局: true 或 false (默认: false)"
- name: create_variable_in_variable_set
  description: 在变量集中创建新变量。
  params:
    variable_set_id: "变量集 ID"
    key: "变量键/名称"
    value: "变量值"
    category: "可选。变量类别: ''terraform'' 或 ''env'' (默认: ''terraform'')"
    description: "可选。变量描述"
    sensitive: "可选。变量是否敏感: true 或 false (默认: false)"
    hcl: "可选。变量是否为 HCL: true 或 false (默认: false)"
- name: delete_variable_in_variable_set
  description: 从变量集中删除变量。
  params:
    variable_set_id: "变量集 ID"
    variable_id: "要删除的变量 ID"
- name: attach_variable_set_to_workspaces
  description: 将变量集附加到一个或多个工作区，使这些工作区可以使用这些变量。
  params:
    variable_set_id: "变量集 ID"
    workspace_ids: "逗号分隔的工作区 ID 列表"
- name: detach_variable_set_from_workspaces
  description: 从一个或多个工作区分离变量集。
  params:
    variable_set_id: "变量集 ID"
    workspace_ids: "逗号分隔的工作区 ID 列表"
- name: read_workspace_tags
  description: 读取 Terraform 工作区的所有标签。标签有助于组织和过滤工作区。
  params:
    terraform_org_name: "Terraform 组织名称"
    workspace_name: "工作区名称"
- name: create_workspace_tags
  description: 向 Terraform 工作区添加标签。对键值标签使用 key:value 格式。
  params:
    terraform_org_name: "Terraform 组织名称"
    workspace_name: "工作区名称"
    tags: "要添加的逗号分隔标签名称列表 (例如 ''environment:production,team:platform'')"
- name: search_modules
  description: 在公共 Terraform Registry 中搜索 Terraform 模块。返回匹配模块列表，包含下载次数和验证状态。
  params:
    module_query: "搜索 Terraform 模块的查询 (例如 ''vpc aws''、''kubernetes'')"
    current_offset: "可选。分页的当前偏移量 (默认: 0)"
- name: get_module_details
  description: 获取特定 Terraform 模块的详细文档，包括输入、输出、依赖项和使用示例。您必须先调用 ''search_modules'' 以获取 module_id。
  params:
    module_id: "来自 search_modules 的精确 module_id (例如 ''terraform-aws-modules/vpc/aws/6.4.0'')"
- name: get_latest_module_version
  description: 从公共注册表获取 Terraform 模块的最新版本。
  params:
    module_publisher: "模块的发布者 (例如 ''hashicorp''、''terraform-aws-modules'')"
    module_name: "模块的名称 (例如 ''vpc''、''eks'')"
    module_provider: "模块的提供者 (例如 ''aws''、''google''、''azurerm'')"
- name: search_providers
  description: 搜索 Terraform 提供者文档。返回匹配资源、数据源或指南的列表。在调用 ''get_provider_details'' 之前必须先调用此工具以获取 provider_doc_id。
  params:
    provider_namespace: "提供者的命名空间 (例如 ''hashicorp'')"
    provider_name: "提供者的名称 (例如 ''aws''、''google''、''azurerm'')"
    service_slug: "要搜索的服务代码 (例如 ''s3''、''ec2''、''vpc'')"
    provider_version: "可选。提供者版本 (例如 ''5.0.0'' 或 ''latest'')"
    provider_data_type: "可选。文档类型: ''resources''、''data-sources''、''functions''、''guides'' 或 ''overview'' (默认: ''resources'')"
- name: get_provider_details
  description: 获取特定 Terraform 提供者资源、数据源或指南的详细文档。您必须先调用 ''search_providers'' 以获取 provider_doc_id。
  params:
    provider_doc_id: "来自 search_providers 的精确 provider_doc_id (例如 ''10177451'')"
- name: get_latest_provider_version
  description: 从公共注册表获取 Terraform 提供者的最新版本。
  params:
    namespace: "提供者的命名空间 (例如 ''hashicorp'')"
    name: "提供者的名称 (例如 ''aws''、''google''、''azurerm'')"
- name: search_policies
  description: 在公共注册表中搜索 Terraform Sentinel 策略。返回匹配的策略集列表。
  params:
    policy_query: "搜索策略的查询 (例如 ''CIS''、''aws security'')"
- name: get_policy_details
  description: 获取特定 Terraform Sentinel 策略的详细文档，包括策略代码和使用说明。您必须先调用 ''search_policies'' 以获取 terraform_policy_id。
  params:
    terraform_policy_id: "来自 search_policies 的精确 terraform_policy_id (例如 ''policies/hashicorp/CIS-Policy-Set-for-AWS-Terraform/1.0.1'')"
- name: search_private_modules
  description: 在您的 Terraform Cloud/Enterprise 组织中搜索私有模块。返回符合搜索条件的模块。
  params:
    terraform_org_name: "Terraform 组织名称"
    search_query: "可选。按名称或命名空间过滤模块的搜索查询"
    page_number: "可选。分页的页码 (从 1 开始)"
    page_size: "可选。每页结果数 (最大 100)"
- name: get_private_module_details
  description: 检索组织中特定私有模块的详细信息，包括输入、输出和使用示例。先调用 ''search_private_modules'' 以获取 private_module_id。
  params:
    terraform_org_name: "Terraform 组织名称"
    private_module_id: "格式为 ''namespace/name/provider'' 的私有模块 ID (例如 ''my-org/vpc/aws'')"
    private_module_version: "可选。要检索的特定版本 (如果未提供则使用最新版本)"
    registry_name: "可选。注册表类型: ''private'' 或 ''public'' (默认: ''private'')"
- name: search_private_providers
  description: 在您的 Terraform Cloud/Enterprise 组织中搜索私有提供者。
  params:
    terraform_org_name: "Terraform 组织名称"
    search_query: "可选。按名称或命名空间过滤提供者的搜索查询"
    registry_name: "可选。注册表类型: ''private'' 或 ''public'' (默认: ''private'')"
    page_number: "可选。分页的页码 (从 1 开始)"
    page_size: "可选。每页结果数 (最大 100)"
- name: get_private_provider_details
  description: 检索组织中特定私有提供者的信息，包括可用版本和使用文档。
  params:
    terraform_org_name: "Terraform 组织名称"
    private_provider_namespace: "私有提供者的命名空间"
    private_provider_name: "私有提供者的名称"
    registry_name: "可选。注册表类型: ''private'' 或 ''public'' (默认: ''private'')"
    include_versions: "可选。是否包含版本信息 (默认: true)"

env:
- name: Terraform Cloud/Enterprise Token
  key: TFE_TOKEN
  description: 用于认证的 Terraform Cloud 或 Enterprise API 令牌。在 Terraform Cloud 的用户设置 > 令牌中生成。
  required: true
  sensitive: true
- name: Terraform Address
  key: TFE_ADDRESS
  description: HCP Terraform 或 Terraform Enterprise 地址。默认为 https://app.terraform.io
  required: false
  sensitive: false

runtime: containerized
containerizedConfig:
  image: ghcr.io/obot-platform/mcp-images/terraform:0.3.2
  port: 8080
  path: "/mcp"
  args:
  - /bin/terraform-mcp-server
  - http
  - --transport-port
  - 8080
  - --transport-host
  - 0.0.0.0

